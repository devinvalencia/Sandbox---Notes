/*
discovery_range_item_ip
discovery_range_item_exclude
discovery_range_item
discovery_range
*/

var exludeRec = new GlideRecord('discovery_range_item_exclude');
var gr = new GlideRecord('discovery_range_item');
gr.addEncodedQuery('parent=0bc598111bad48102c48fc03cc4bcb59^ORparent=b47710511bad48102c48fc03cc4bcbf4^ORparent=f7b658111bad48102c48fc03cc4bcbd1');
gr.query();

while (gr.next()) {
  exludeRec.name = gr.name + ' Excludes';
  exludeRec.type = 'IP Address List'; // type
  exludeRec.parent = gr.sys_id;
  exludeRec.insert();
}

// Get count and sys_id for each applicable range item
// For each qualified range item, insert exclude list where type = list & exlcude parent = range_item

// This is solution If you use ranges for your discovery but to exclude certain ip addresses


// ----------------------------------------------------- //
// Use all characters before 3rd dot to match up with name of exclude list, then populate exclude list sysid

var ipAddresses = [
  "10.1.1.12",
  "10.1.1.200",
  "10.1.1.32",
  "10.1.1.60",
  "10.1.1.61",
  "10.1.1.62",
  "10.1.1.66",
  "10.1.1.68",
  "10.1.1.72",
  "10.1.1.74",
  "10.1.10.16",
  "10.1.10.17",
  "10.1.10.64",
  "10.1.10.65",
  "10.1.100.106",
  "10.1.100.107",
  "10.1.100.108",
  "10.1.100.109",
  "10.1.100.156",
  "10.1.100.166",
  "10.1.100.174",
  "10.1.100.180",
  "10.1.100.183",
  "10.1.100.21",
  "10.1.100.216",
  "10.1.100.217",
  "10.1.100.22",
  "10.1.100.228",
  "10.1.100.229",
  "10.1.100.230",
  "10.1.100.231",
  "10.1.100.236",
  "10.1.100.237",
  "10.1.100.238",
  "10.1.100.239",
  "10.1.100.240",
  "10.1.100.241",
  "10.1.100.242",
  "10.1.100.243",
  "10.1.100.248",
  "10.1.100.253",
  "10.1.100.26",
  "10.1.100.28",
  "10.1.100.33",
  "10.1.100.34",
  "10.1.100.36",
  "10.1.100.37",
  "10.1.100.38",
  "10.1.100.39",
  "10.1.100.40",
  "10.1.100.41",
  "10.1.100.46",
  "10.1.100.85",
  "10.1.100.91",
  "10.1.100.98",
  "10.1.101.151",
  "10.1.101.175",
  "10.1.101.32",
  "10.1.101.48",
  "10.1.101.50",
  "10.1.101.60",
  "10.1.101.61",
  "10.1.101.62",
  "10.1.101.63",
  "10.1.101.66",
  "10.1.101.67",
  "10.1.101.68",
  "10.1.101.70",
  "10.1.101.71",
  "10.1.101.77",
  "10.1.101.81",
  "10.1.101.84",
  "10.1.102.41",
  "10.1.108.24",
  "10.1.108.26",
  "10.1.110.198",
  "10.1.110.215",
  "10.1.112.108",
  "10.1.112.112",
  "10.1.112.113",
  "10.1.112.124",
  "10.1.112.126",
  "10.1.112.136",
  "10.1.112.137",
  "10.1.112.147",
  "10.1.112.157",
  "10.1.112.172",
  "10.1.112.173",
  "10.1.112.174",
  "10.1.112.175",
  "10.1.112.176",
  "10.1.112.184",
  "10.1.112.202",
  "10.1.112.203",
  "10.1.112.208",
  "10.1.112.210",
  "10.1.112.211",
  "10.1.112.215",
  "10.1.112.237",
  "10.1.112.241",
  "10.1.112.242",
  "10.1.112.243",
  "10.1.112.38",
  "10.1.112.39",
  "10.1.112.71",
  "10.1.112.82",
  "10.1.112.94",
  "10.1.118.118",
  "10.1.119.126",
  "10.1.120.239",
  "10.1.134.103",
  "10.1.134.251",
  "10.1.134.252",
  "10.1.134.38",
  "10.1.134.51",
  "10.1.137.142",
  "10.1.137.144",
  "10.1.137.146",
  "10.1.137.179",
  "10.1.137.200",
  "10.1.137.201",
  "10.1.139.149",
  "10.1.139.179",
  "10.1.139.183",
  "10.1.139.191",
  "10.1.139.240",
  "10.1.139.241",
  "10.1.14.200",
  "10.1.14.5",
  "10.1.151.128",
  "10.1.151.129",
  "10.1.151.130",
  "10.1.151.138",
  "10.1.151.139",
  "10.1.151.142",
  "10.1.151.143",
  "10.1.151.5",
  "10.1.151.8",
  "10.1.151.9",
  "10.1.154.142",
  "10.1.154.143",
  "10.1.154.5",
  "10.1.16.11",
  "10.1.16.21",
  "10.1.16.252",
  "10.1.16.253",
  "10.1.16.32",
  "10.1.16.33",
  "10.1.16.59",
  "10.1.16.70",
  "10.1.2.212",
  "10.1.2.213",
  "10.1.2.216",
  "10.1.2.217",
  "10.1.2.220",
  "10.1.2.221",
  "10.1.2.222",
  "10.1.2.223",
  "10.1.2.224",
  "10.1.2.225",
  "10.1.2.227",
  "10.1.2.228",
  "10.1.2.229",
  "10.1.2.230",
  "10.1.2.231",
  "10.1.2.233",
  "10.1.2.236",
  "10.1.2.240",
  "10.1.2.241",
  "10.1.2.243",
  "10.1.2.244",
  "10.1.2.245",
  "10.1.2.246",
  "10.1.2.247",
  "10.1.2.248",
  "10.1.2.249",
  "10.1.2.250",
  "10.1.2.251",
  "10.1.2.252",
  "10.1.2.253",
  "10.1.20.244",
  "10.1.20.245",
  "10.1.20.246",
  "10.1.20.247",
  "10.1.202.128",
  "10.1.202.129",
  "10.1.202.130",
  "10.1.202.131",
  "10.1.202.132",
  "10.1.202.133",
  "10.1.202.134",
  "10.1.202.135",
  "10.1.202.136",
  "10.1.202.137",
  "10.1.202.138",
  "10.1.202.139",
  "10.1.202.140",
  "10.1.202.141",
  "10.1.202.142",
  "10.1.202.143",
  "10.1.202.144",
  "10.1.202.145",
  "10.1.202.146",
  "10.1.202.147",
  "10.1.202.32",
  "10.1.202.33",
  "10.1.202.34",
  "10.1.202.35",
  "10.1.202.36",
  "10.1.202.37",
  "10.1.202.38",
  "10.1.202.39",
  "10.1.202.40",
  "10.1.202.41",
  "10.1.202.42",
  "10.1.202.43",
  "10.1.202.44",
  "10.1.202.45",
  "10.1.202.46",
  "10.1.202.47",
  "10.1.202.48",
  "10.1.202.49",
  "10.1.202.50",
  "10.1.203.112",
  "10.1.203.113",
  "10.1.203.114",
  "10.1.203.115",
  "10.1.203.120",
  "10.1.203.121",
  "10.1.203.122",
  "10.1.203.123",
  "10.1.203.16",
  "10.1.203.160",
  "10.1.203.168",
  "10.1.203.17",
  "10.1.203.18",
  "10.1.203.19",
  "10.1.203.20",
  "10.1.203.24",
  "10.1.203.25",
  "10.1.203.26",
  "10.1.203.27",
  "10.1.203.28",
  "10.1.203.64",
  "10.1.203.72",
  "10.1.224.10",
  "10.1.224.160",
  "10.1.226.23",
  "10.1.227.131",
  "10.1.227.20",
  "10.1.227.79",
  "10.1.228.16",
  "10.1.229.101",
  "10.1.230.114",
  "10.1.230.118",
  "10.1.230.124",
  "10.1.230.99",
  "10.1.231.19",
  "10.1.231.49",
  "10.1.231.53",
  "10.1.232.106",
  "10.1.232.108",
  "10.1.232.114",
  "10.1.232.129",
  "10.1.232.136",
  "10.1.232.139",
  "10.1.232.144",
  "10.1.232.173",
  "10.1.232.176",
  "10.1.232.179",
  "10.1.232.184",
  "10.1.232.185",
  "10.1.232.188",
  "10.1.232.194",
  "10.1.232.195",
  "10.1.232.198",
  "10.1.232.199",
  "10.1.232.20",
  "10.1.232.40",
  "10.1.232.47",
  "10.1.232.52",
  "10.1.232.61",
  "10.1.232.74",
  "10.1.232.75",
  "10.1.232.87",
  "10.1.30.105",
  "10.1.30.108",
  "10.1.30.109",
  "10.1.30.12",
  "10.1.30.120",
  "10.1.30.121",
  "10.1.30.160",
  "10.1.30.168",
  "10.1.30.20",
  "10.1.30.21",
  "10.1.30.22",
  "10.1.30.24",
  "10.1.30.242",
  "10.1.30.30",
  "10.1.30.35",
  "10.1.30.36",
  "10.1.30.60",
  "10.1.30.74",
  "10.1.30.80",
  "10.1.30.81",
  "10.1.30.82",
  "10.1.30.83",
  "10.1.30.84",
  "10.1.30.85",
  "10.1.30.86",
  "10.1.30.87",
  "10.1.30.89",
  "10.1.30.90",
  "10.1.4.124",
  "10.1.4.125",
  "10.1.4.235",
  "10.1.4.236",
  "10.1.4.237",
  "10.1.4.239",
  "10.1.4.240",
  "10.1.4.241",
  "10.1.4.242",
  "10.1.4.243",
  "10.1.4.244",
  "10.1.4.245",
  "10.1.4.246",
  "10.1.4.247",
  "10.1.4.248",
  "10.1.4.90",
  "10.1.4.92",
  "10.1.4.93",
  "10.1.4.94",
  "10.1.4.98",
  "10.1.40.104",
  "10.1.40.105",
  "10.1.40.106",
  "10.1.40.107",
  "10.1.40.108",
  "10.1.40.109",
  "10.1.40.11",
  "10.1.40.110",
  "10.1.40.111",
  "10.1.40.135",
  "10.1.40.136",
  "10.1.40.140",
  "10.1.40.141",
  "10.1.40.142",
  "10.1.40.143",
  "10.1.40.144",
  "10.1.40.152",
  "10.1.40.156",
  "10.1.40.157",
  "10.1.40.158",
  "10.1.40.159",
  "10.1.40.160",
  "10.1.40.161",
  "10.1.40.162",
  "10.1.40.163",
  "10.1.40.166",
  "10.1.40.168",
  "10.1.40.174",
  "10.1.40.175",
  "10.1.40.176",
  "10.1.40.177",
  "10.1.40.178",
  "10.1.40.184",
  "10.1.40.185",
  "10.1.40.186",
  "10.1.40.187",
  "10.1.40.188",
  "10.1.40.189",
  "10.1.40.190",
  "10.1.40.191",
  "10.1.40.192",
  "10.1.40.193",
  "10.1.40.194",
  "10.1.40.196",
  "10.1.40.198",
  "10.1.40.200",
  "10.1.40.201",
  "10.1.40.202",
  "10.1.40.203",
  "10.1.40.204",
  "10.1.40.205",
  "10.1.40.206",
  "10.1.40.207",
  "10.1.40.208",
  "10.1.40.209",
  "10.1.40.210",
  "10.1.40.211",
  "10.1.40.212",
  "10.1.40.213",
  "10.1.40.214",
  "10.1.40.218",
  "10.1.40.219",
  "10.1.40.229",
  "10.1.40.230",
  "10.1.40.231",
  "10.1.40.232",
  "10.1.40.233",
  "10.1.40.234",
  "10.1.40.235",
  "10.1.40.236",
  "10.1.40.237",
  "10.1.40.238",
  "10.1.40.239",
  "10.1.40.241",
  "10.1.40.242",
  "10.1.40.243",
  "10.1.40.244",
  "10.1.40.245",
  "10.1.40.246",
  "10.1.40.247",
  "10.1.40.248",
  "10.1.40.249",
  "10.1.40.250",
  "10.1.40.32",
  "10.1.40.33",
  "10.1.40.34",
  "10.1.40.35",
  "10.1.40.36",
  "10.1.40.37",
  "10.1.40.38",
  "10.1.40.39",
  "10.1.40.40",
  "10.1.40.41",
  "10.1.40.42",
  "10.1.40.43",
  "10.1.40.60",
  "10.1.40.61",
  "10.1.40.62",
  "10.1.40.63",
  "10.1.40.64",
  "10.1.40.66",
  "10.1.40.68",
  "10.1.40.70",
  "10.1.40.71",
  "10.1.40.72",
  "10.1.40.73",
  "10.1.40.74",
  "10.1.40.80",
  "10.1.40.81",
  "10.1.40.82",
  "10.1.40.83",
  "10.1.40.84",
  "10.1.41.10",
  "10.1.41.106",
  "10.1.41.107",
  "10.1.41.108",
  "10.1.41.109",
  "10.1.41.110",
  "10.1.41.111",
  "10.1.41.112",
  "10.1.41.114",
  "10.1.41.115",
  "10.1.41.13",
  "10.1.41.137",
  "10.1.41.138",
  "10.1.41.14",
  "10.1.41.144",
  "10.1.41.145",
  "10.1.41.148",
  "10.1.41.149",
  "10.1.41.15",
  "10.1.41.150",
  "10.1.41.151",
  "10.1.41.184",
  "10.1.41.185",
  "10.1.41.186",
  "10.1.41.187",
  "10.1.41.228",
  "10.1.41.229",
  "10.1.41.230",
  "10.1.41.240",
  "10.1.41.241",
  "10.1.41.242",
  "10.1.41.243",
  "10.1.41.244",
  "10.1.41.245",
  "10.1.41.246",
  "10.1.41.250",
  "10.1.41.28",
  "10.1.41.4",
  "10.1.41.40",
  "10.1.41.48",
  "10.1.41.49",
  "10.1.41.58",
  "10.1.41.59",
  "10.1.41.6",
  "10.1.41.72",
  "10.1.41.87",
  "10.1.41.88",
  "10.1.41.89",
  "10.1.41.9",
  "10.1.41.90",
  "10.1.41.91",
  "10.1.41.92",
  "10.1.41.93",
  "10.1.41.94",
  "10.1.41.95",
  "10.1.41.96",
  "10.1.41.97",
  "10.1.41.98",
  "10.1.5.238",
  "10.1.5.252",
  "10.1.5.36",
  "10.1.5.38",
  "10.1.50.100",
  "10.1.50.101",
  "10.1.50.114",
  "10.1.50.171",
  "10.1.50.201",
  "10.1.50.21",
  "10.1.50.214",
  "10.1.50.240",
  "10.1.50.241",
  "10.1.50.242",
  "10.1.50.244",
  "10.1.50.245",
  "10.1.50.246",
  "10.1.50.249",
  "10.1.50.38",
  "10.1.50.39",
  "10.1.50.54",
  "10.1.50.55",
  "10.1.50.78",
  "10.1.50.79",
  "10.1.50.99",
  "10.1.51.240",
  "10.1.51.242",
  "10.1.51.244",
  "10.1.51.248",
  "10.1.51.252",
  "10.1.51.253",
  "10.1.74.220",
  "10.1.74.221",
  "10.1.80.16",
  "10.1.80.17",
  "10.1.80.18",
  "10.1.80.19",
  "10.1.80.20",
  "10.1.80.21",
  "10.1.80.22",
  "10.1.80.23",
  "10.1.80.236",
  "10.1.80.237",
  "10.1.80.238",
  "10.1.80.239",
  "10.1.80.24",
  "10.1.80.240",
  "10.1.80.241",
  "10.1.80.242",
  "10.1.80.243",
  "10.1.80.244",
  "10.1.80.245",
  "10.1.80.246",
  "10.1.80.247",
  "10.1.80.248",
  "10.1.80.25",
  "10.1.80.252",
  "10.1.80.253",
  "10.1.80.254",
  "10.1.80.26",
  "10.1.80.27",
  "10.1.80.28",
  "10.1.80.51",
  "10.1.80.52",
  "10.1.80.53",
  "10.1.80.60",
  "10.1.80.61",
  "10.1.80.62",
  "10.1.80.63",
  "10.1.81.132",
  "10.1.81.133",
  "10.1.81.134",
  "10.1.81.135",
  "10.1.81.142",
  "10.1.81.143",
  "10.1.81.18",
  "10.1.81.190",
  "10.1.81.191",
  "10.1.81.41",
  "10.1.81.42",
  "10.1.81.96",
  "10.1.81.97",
  "10.1.81.98",
  "10.1.81.99",
  "10.255.112.172",
  "10.255.112.173",
  "10.255.112.174",
  "10.255.112.176",
  "10.255.112.22",
  "10.255.224.1",
  "10.255.224.193",
  "10.255.224.65",
  "10.255.225.1",
  "10.255.225.129",
  "10.255.225.180",
  "10.255.225.193",
  "10.255.225.65",
  "10.255.226.1",
  "10.255.226.129",
  "10.255.226.65",
  "10.255.227.193",
  "10.255.227.65",
  "10.255.228.1",
  "10.255.229.1",
  "10.255.229.65",
  "10.255.230.1",
  "10.255.230.129",
  "10.255.230.193",
  "10.255.231.1",
  "10.255.231.129",
  "10.255.231.193",
  "10.255.232.1",
  "10.255.232.129",
  "10.255.232.193",
  "10.255.232.65",
  "10.255.233.129",
  "10.255.233.193",
  "10.255.233.65",
  "10.255.234.1",
  "10.255.234.129",
  "10.255.234.193",
  "10.255.234.65",
  "10.255.235.1",
  "10.255.235.10",
  "10.255.235.11",
  "10.255.235.129",
  "10.255.235.138",
  "10.255.235.139",
  "10.255.235.193",
  "10.255.235.65",
  "10.255.236.1",
  "10.255.236.129",
  "10.255.236.65",
  "10.255.40.100",
  "10.255.40.101",
  "10.255.40.102",
  "10.255.40.95",
  "10.255.40.96",
  "10.255.40.97",
  "10.255.41.200",
  "10.255.41.229",
  "10.255.41.230",
  "10.255.41.232",
  "10.255.41.233",
  "10.255.41.234",
  "10.255.41.235",
  "10.255.41.236",
  "10.255.41.237",
  "10.255.41.238",
  "10.255.41.239",
  "10.255.41.240",
  "10.255.41.241",
  "10.255.41.242",
  "10.255.41.243",
  "10.255.41.244",
  "10.255.41.245",
  "10.255.41.246",
  "10.255.41.247",
  "10.255.41.248",
  "10.255.41.249",
  "10.255.41.253",
  "10.255.41.41",
  "10.255.41.42",
  "10.255.41.43",
  "10.255.41.44",
  "10.255.41.45",
  
];
var ipRecord = new GlideRecord('discovery_range_item_ip');
var gr = new GlideRecord('discovery_range_item_exclude');
gr.query();

while (gr.next()) {
var truncExclude = getSubString(gr.getValue('name'));
  for (var n = 0; ipAddresses.length > n; n++) {
    var truncIpAddress = getSubString(ipAddresses[n]);
    //gs.info(truncExclude + ' vs ' + truncIpAddress); // <<
      if (truncExclude == truncIpAddress) {
        //gs.info("  Match!  "); // <<
        ipRecord.ip_address = ipAddresses[n];
        ipRecord.exclude_parent = gr.sys_id;
        ipRecord.insert();
     }
  }
}

function getSubString(x) {
var grName = x;
var slen = grName.length;
var dotCount = 0;
var i = 0;
  while ( (i < slen) && ( dotCount < 3) ) {
    if ( grName.substring(i, i+1) == '.' ) { 
		dotCount++;
  }
    i++;
  }
  return grName.substring(0, i);
}